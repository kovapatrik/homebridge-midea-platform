{
  "pluginAlias": "midea",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "type": "object",
    "properties": {
      "user": {
        "title": "Midea Account Email",
        "type": "string",
        "required": true
      },
      "password": {
        "title": "Midea Account Password",
        "type": "string",
        "required": true
      },
      "registeredApp": {
        "title": "Registered App",
        "type": "string",
        "description": "Select the app where your devices are registered in.",
        "enum": [
          "Midea SmartHome (MSmartHome)",
          "NetHome Plus",
          "Meiju"
        ],
        "default": "Midea SmartHome (MSmartHome)",
        "required": true
      },
      "refreshInterval": {
        "title": "Interval, in seconds, to query Midea devices for state",
        "type": "number",
        "required": false,
        "default": 30,
        "minimum": 0,
        "maximum": 86400,
        "description": "The plugin will query devices for their current state (temperature, humidity, etc.). Some Midea devices update the plugin automatically on any change, others require that the device is queried.  You can observe in the log whenever a state changes.  The default is 30 seconds, the maximum is 86,400 (24 hours).  Setting value to 0 (zero) disables polling and updates will only be noted if devices sends it automatically. "
      },
      "forceLogin": {
        "title": "Login to Midea Cloud every restart",
        "type": "boolean",
        "required": false,
        "default": false,
        "description": "Force the plugin to login and retrieve new device token/key pair every time the plugin starts. By default login and token/key retrieval occurs only if a new Midea device is discovered on the network."
      },
      "verbose": {
        "title": "Enable verbose logging",
        "type": "boolean",
        "required": false,
        "default": true,
        "description": "Enables additional debug logging that may help a developer identify problems when working on Midea device support.  Homebridge must be running with debug enabled for any debug logging to be visible."
      },
      "devices": {
        "title": "Devices",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "ip": {
              "title": "Device IP Address",
              "description": "The IP address of the device you want to add.",
              "type": "string",
              "required": true
            },
            "name": {
              "title": "Device Name",
              "description": "This is the name that will be used in HomeKit.",
              "type": "string"
            },
            "deviceType": {
              "title": "Device Type",
              "description": "Select the type of device you are adding.",
              "type": "string",
              "enum": [
                "Air Conditioner"
              ],
              "required": true
            },
            "singleAccessory": {
              "title": "Single Accessory",
              "description": "Toggles if the AC and the optional sub accessories (e.g.: outdoor temperature sensor, display switch) are combined into one accessory or not.",
              "type": "boolean",
              "default": true
            },
            "AC_options": {
              "title": "Options",
              "type": "object",
              "condition": {
                "functionBody": "return model.devices[arrayIndices].deviceType === 'Air Conditioner';"
              },
              "properties": {
                "swingMode": {
                  "title": "Swing Mode",
                  "description": "Set swing mode of the unit. If you AC does not support this feature then leave it on None.",
                  "type": "string",
                  "enum": [
                    "Vertical",
                    "Horizontal",
                    "Both"
                  ]
                },
                "outDoorTemp": {
                  "title": "Outdoor Temperature",
                  "description": "Toggles if the outdoor temperature is created with the accessory.",
                  "type": "boolean",
                  "default": false
                },
                "audioFeedback": {
                  "title": "Audio Feedback",
                  "description": "Toggles if the unit beeps when a command is sent.",
                  "type": "boolean",
                  "default": false
                },
                "ecoSwitch": {
                  "title": "Eco Mode Switch",
                  "description": "Toggles if the ECO mode switch is created with the accessory.",
                  "type": "boolean",
                  "default": true
                },
                "switchDisplay": {
                  "type": "object",
                  "properties": {
                    "flag": {
                      "title": "Switch Display",
                      "description": "Toggles if a switch, which can turn the display on or off will be created or not.",
                      "type": "boolean",
                      "default": true
                    },
                    "command": {
                      "title": "Switch Display Alternate Command",
                      "description": "Use this if the switch display command does not work. If it doesn't work either way then you unit does not support this feature.",
                      "type": "boolean",
                      "default": false
                    }
                  }
                },
                "minTemp": {
                  "title": "Minimum Temperature",
                  "type": "integer",
                  "default": 16
                },
                "maxTemp": {
                  "title": "Maximum Temperature",
                  "type": "integer",
                  "default": 30
                },
                "tempStep": {
                  "title": "Temperature Step",
                  "type": "integer",
                  "default": 1,
                  "enum": [
                    0.5,
                    1
                  ]
                },
                "fahrenHeit": {
                  "title": "Fahrenheit",
                  "description": "Toggles if the temperature on the unit is displayed in Fahrenheit or Celsius.",
                  "type": "boolean",
                  "default": false
                },
                "fanOnlyMode": {
                  "title": "Fan Only Mode",
                  "description": "Toggles if the fan only mode is created with the accessory.",
                  "type": "boolean",
                  "default": false
                }
              }
            }
          }
        }
      }
    }
  },
  "layout": [
    {
      "key": "user",
      "type": "string"
    },
    {
      "key": "password",
      "type": "string"
    },
    {
      "key": "registeredApp",
      "type": "string"
    },
    {
      "key": "refreshInterval",
      "type": "number"
    },
    {
      "key": "forceLogin",
      "type": "boolean"
    },
    {
      "key": "verbose",
      "type": "boolean"
    },
    {
      "key": "devices",
      "type": "array",
      "orderable": true,
      "buttonText": "Add Device",
      "items": [
        "devices[].ip",
        "devices[].name",
        "devices[].deviceType",
        "devices[].singleAccessory",
        {
          "key": "devices[].AC_options",
          "expandable": true,
          "expanded": false,
          "title": "Air Conditioner Options",
          "items": [
            "devices[].AC_options.swingMode",
            "devices[].AC_options.outDoorTemp",
            "devices[].AC_options.audioFeedback",
            "devices[].AC_options.ecoSwitch",
            {
              "key": "devices[].AC_options.switchDisplay",
              "items": [
                "devices[].AC_options.switchDisplay.flag",
                "devices[].AC_options.switchDisplay.command"
              ]
            },
            "devices[].AC_options.minTemp",
            "devices[].AC_options.maxTemp",
            "devices[].AC_options.tempStep",
            "devices[].AC_options.fahrenHeit",
            "devices[].AC_options.fanOnlyMode"
          ]
        }
      ]
    }
  ]
}